<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<title>Exportando tabelas HTML para o Excel com jQuery e PHP</title>
<script type="text/javascript" src="jquery-1.3.2.min.js"></script>
<script language="javascript">
$(document).ready(function() {
	$(".botaoExcel").click(function(event) {
		$("#dados_a_enviar").val( $("<div>").append( $("#Exportar_para_Excel").eq(0).clone()).html());
		$("#FormularioExportacao").submit();
});
});
</script>
<style type="text/css">
.botaoExcel{cursor:pointer;}
</style>
</head>
<body>
<table width="50%" border="1" cellpadding="10" cellspacing="0" bordercolor="#666666" id="Exportar_para_Excel" style="border-collapse:collapse;">
<tr>
<td>Célula1</td>
<td>Célula2</td>
<td>Célula3</td>
<td>Célula4</td>
<td>Célula5</td>
</tr>
<tr>
<td>Célula6</td>
<td>Célula7</td>
<td>Célula8</td>
<td>Célula9</td>
<td>Célula10</td>
</tr>
</table>
<form action="arquivoExcel.php" method="post" target="_blank" id="FormularioExportacao">
<p>Exportar para Excel  <img src="export_to_excel.gif" class="botaoExcel" /></p>
<input type="hidden" id="dados_a_enviar" name="dados_a_enviar" />
</form>
</body>
</html>
